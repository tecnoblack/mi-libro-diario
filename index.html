<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Libro Diario Profesional</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f0f2f5; padding: 20px; color: #333; }
        .container { max-width: 1100px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        /* Encabezado solicitado con borde azul y editable */
        .header-box { border: 2px solid #2563eb; text-align: center; padding: 20px; margin-bottom: 25px; border-radius: 6px; }
        .editable { outline: none; transition: background 0.3s; padding: 2px 5px; }
        .editable:focus { background: #eef2ff; border-bottom: 1px dashed #2563eb; }
        .header-box h1 { margin: 0; font-size: 1.8rem; text-transform: uppercase; }
        .header-box p { margin: 5px 0; font-weight: bold; }
        .header-box h2 { margin: 15px 0 0 0; text-decoration: underline; font-size: 1.3rem; }

        /* Apartado Resumen del Asiento */
        .resumen-seccion { margin-bottom: 20px; }
        .resumen-seccion label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 0.95rem; }
        .input-resumen { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; box-sizing: border-box; }

        /* Tabla Estilo Profesional */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background-color: #2563eb; color: white; padding: 12px; text-align: left; font-size: 0.9rem; border: 1px solid #1d4ed8; }
        td { padding: 10px; border: 1px solid #e5e7eb; }

        .input-tabla { width: 100%; border: none; background: transparent; outline: none; font-size: 1rem; }
        .btn-add { background-color: #059669; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; margin-bottom: 15px; }
        .btn-add:hover { background-color: #047857; }
        
        .total-row { background-color: #f8fafc; font-weight: bold; font-size: 1.1rem; }
        .status-msg { margin-top: 15px; font-weight: bold; }
        .btn-guardar { background-color: #2563eb; color: white; border: none; padding: 15px; width: 100%; border-radius: 4px; cursor: pointer; font-weight: bold; margin-top: 20px; font-size: 1.1rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-box">
        <h1 contenteditable="true" class="editable">COMERCIAL A B C, C.A.</h1>
        <p contenteditable="true" class="editable">RIF: J-00000000-0</p>
        <h2 contenteditable="true" class="editable">LIBRO DIARIO</h2>
        <p contenteditable="true" class="editable">PERÍODO: FEBRERO 2026</p>
    </div>

    <div class="resumen-seccion">
        <label>Resumen del Asiento</label>
        <input type="text" class="input-resumen" placeholder="Ej. Venta de mercancía al contado según factura...">
    </div>

    <button class="btn-add" onclick="agregarFila()">+ Añadir Cuenta</button>

    <table>
        <thead>
            <tr>
                <th style="width: 12%;">FECHA</th>
                <th style="width: 38%;">CUENTA</th>
                <th style="width: 10%;">REF</th>
                <th style="width: 20%;">DÉBITO</th>
                <th style="width: 20%;">CRÉDITO</th>
            </tr>
        </thead>
        <tbody id="tabla-body">
            </tbody>
        <tfoot>
            <tr class="total-row">
                <td colspan="3" style="text-align: right; padding-right: 20px;">TOTALES:</td>
                <td id="total-debito">0.00</td>
                <td id="total-credito">0.00</td>
            </tr>
        </tfoot>
    </table>

    <div id="mensaje" class="status-msg"></div>
    <button class="btn-guardar">Guardar Asiento</button>
</div>

<script>
    const TASA_IVA = 0.16;

    function obtenerFecha() {
        const d = new Date();
        return `${String(d.getDate()).padStart(2, '0')}/${String(d.getMonth() + 1).padStart(2, '0')}/${d.getFullYear()}`;
    }

    function agregarFila(nombre = "", ref = "", deb = 0, cre = 0) {
        const tbody = document.getElementById('tabla-body');
        const esPrimera = tbody.rows.length === 0;
        const fila = tbody.insertRow();

        fila.innerHTML = `
            <td><input type="text" class="input-tabla" value="${esPrimera ? obtenerFecha() : ''}" readonly></td>
            <td><input type="text" class="input-tabla" value="${nombre}" placeholder="..."></td>
            <td><input type="text" class="input-tabla" value="${ref}" placeholder="0"></td>
            <td><input type="number" class="input-tabla val-debito" value="${deb}" step="0.01" oninput="controlIVA(this)"></td>
            <td><input type="number" class="input-tabla val-credito" value="${cre}" step="0.01" oninput="calcular()"></td>
        `;
        calcular();
    }

    function controlIVA(input) {
        const tbody = document.getElementById('tabla-body');
        const monto = parseFloat(input.value);

        // LOGICA FUNCIONAL: Si es la primera fila y pones un monto en Débito
        if (tbody.rows.length === 1 && monto > 0) {
            const base = monto / (1 + TASA_IVA);
            const iva = monto - base;

            // Agregamos las filas automáticas con sus REF (2 y 3)
            agregarFila("Venta", "2", 0, base.toFixed(2));
            agregarFila("Débito Fiscal", "3", 0, iva.toFixed(2));
        }
        calcular();
    }

    function calcular() {
        let dTotal = 0, cTotal = 0;
        document.querySelectorAll('.val-debito').forEach(i => dTotal += parseFloat(i.value || 0));
        document.querySelectorAll('.val-credito').forEach(i => cTotal += parseFloat(i.value || 0));

        document.getElementById('total-debito').innerText = dTotal.toFixed(2);
        document.getElementById('total-credito').innerText = cTotal.toFixed(2);

        const m = document.getElementById('mensaje');
        if (dTotal.toFixed(2) === cTotal.toFixed(2) && dTotal > 0) {
            m.innerText = "✓ Asiento cuadrado.";
            m.style.color = "#059669";
        } else {
            m.innerText = "⚠ El asiento no cuadra (Débito ≠ Crédito).";
            m.style.color = "#dc2626";
        }
    }

    // Al cargar: Primera fila vacía en Cuenta y REF 1
    window.onload = () => {
        agregarFila("", "1"); // Cuenta vacía para que tú escribas "Caja" o lo que gustes
    };
</script>

</body>
</html>
